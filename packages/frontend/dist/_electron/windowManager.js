var a=['auth','taskLauncher','Window\x20Tag\x20is\x20Unsupported!','loadURL','get','transitionToDeauthedState','addWindowEventListeners','ready-to-show','handleShow','handleClose','NEBULA_ENV_SHOW_DEVTOOLS','webContents','openDevTools','_windows','set','_notifyUpdateWindowIDs','info','Starting\x20update\x20check...','isDevelopment','log','Window\x20was\x20closed,\x20id\x20=\x20','delete','closeAllCaptchaWindows','stop','forEach','transitiontoAuthedState','start','close','push','send','UpdateWindowIDs','spawnCaptchaWindow','sender','FinishCreateNewWindow','[ERROR]:\x20%s','message','UpdateMessage','from','keys','startHarvestingCaptcha','stopHarvestingCaptcha','stopHarvesting','getNextCaptcha','exports','electron','electron-updater','electron-log','../common/constants','./env','./windows','./captchaWindowManager','setUpEnvironment','logger','level','debug','autoInstallOnAppQuit','update-downloaded','NEW\x20UPDATE\x20DOWNLOADED:\x20','dialog','showMessageBox','Version\x20','Update\x20Now','Update\x20Later','main','_main','_context','_aboutDialog','_auth','_captchaWindowManager','ipc','RequestCreateNewWindow','_onRequestCreateNewWindow','bind','_onRequestSendMessage','RequestGetWindowIDs','_onRequestGetWindowIDs','RequestCloseWindow','_onRequestWindowClose','RequestCheckForUpdates','reload','BrowserWindow','toggleDevTools','getFocusedWindow','createNewWindow','_authManager','getSession','includes','about'];(function(c,d){var e=function(f){while(--f){c['push'](c['shift']());}};e(++d);}(a,0x134));var b=function(c,d){c=c-0x0;var e=a[c];return e;};const Electron=require(b('0x0'));const {autoUpdater}=require(b('0x1'));const log=require(b('0x2'));const IPCKeys=require(b('0x3'));const nebulaEnv=require(b('0x4'));const {createAboutWindow,createAuthWindow,createMainWindow,urls}=require(b('0x5'));const CaptchaWindowManager=require(b('0x6'));nebulaEnv[b('0x7')]();autoUpdater[b('0x8')]=log;autoUpdater[b('0x8')]['transports']['file'][b('0x9')]=b('0xa');autoUpdater[b('0xb')]=![];autoUpdater['on'](b('0xc'),c=>{log['info'](b('0xd'),c);const {version}=c;Electron[b('0xe')][b('0xf')]({'type':'question','title':'New\x20Update','message':b('0x10')+version+'\x20has\x20been\x20downloaded!\x20Nebula\x20will\x20automatically\x20update\x20on\x20the\x20next\x20launch.\x20Would\x20you\x20like\x20to\x20update\x20now?','buttons':[b('0x11'),b('0x12')],'cancelId':0x1,'defaultId':0x0},d=>{if(d===0x0){autoUpdater['quitAndInstall']();}});});class WindowManager{get[b('0x13')](){return this[b('0x14')];}constructor(e){this[b('0x15')]=e;this['_windows']=new Map();this[b('0x16')]=null;this['_main']=null;this[b('0x17')]=null;this[b('0x18')]=new CaptchaWindowManager(e);e[b('0x19')]['on'](IPCKeys[b('0x1a')],this[b('0x1b')][b('0x1c')](this));e[b('0x19')]['on'](IPCKeys['RequestSendMessage'],this[b('0x1d')][b('0x1c')](this));e[b('0x19')]['on'](IPCKeys[b('0x1e')],this[b('0x1f')]['bind'](this));e['ipc']['on'](IPCKeys[b('0x20')],this[b('0x21')]['bind'](this));e[b('0x19')]['on'](IPCKeys[b('0x22')],WindowManager['_onRequestCheckForUpdates'][b('0x1c')](this));}static[b('0x23')](f){const g=f||Electron[b('0x24')]['getFocusedWindow']();if(g){g[b('0x23')]();}}static[b('0x25')](h){const i=h||Electron[b('0x24')][b('0x26')]();if(i){i[b('0x25')]();}}async[b('0x27')](j){let k;const l=await this['_context'][b('0x28')][b('0x29')]();if(l||['auth','about'][b('0x2a')](j)){switch(j){case b('0x2b'):{if(this['_aboutDialog']){return this[b('0x16')];}k=createAboutWindow();this[b('0x16')]=k;break;}case b('0x2c'):{if(this[b('0x17')]){return this['_auth'];}k=createAuthWindow();this['_auth']=k;break;}case'main':{if(this['_main']){return this[b('0x14')];}k=createMainWindow();this[b('0x14')]=k;this[b('0x15')][b('0x2d')]['start']();break;}default:{throw new Error(b('0x2e'));}}k[b('0x2f')](urls[b('0x30')](j));this['addWindowEventListeners'](k);return k;}return this[b('0x31')]();}[b('0x32')](m){m['on'](b('0x33'),this[b('0x34')](m));m['on']('close',this[b('0x35')](m));}[b('0x34')](n){return()=>{if(nebulaEnv['isDevelopment']()||process['env'][b('0x36')]){console['log']('Window\x20was\x20opened,\x20id\x20=\x20'+n['id']);n[b('0x37')][b('0x38')]();}this[b('0x39')][b('0x3a')](n['id'],n);this[b('0x3b')](n['id']);n['show']();if(n===this[b('0x14')]){log[b('0x3c')](b('0x3d'));autoUpdater['checkForUpdatesAndNotify']();}};}[b('0x35')](o){const p=o['id'];return()=>{if(nebulaEnv[b('0x3e')]()){console[b('0x3f')](b('0x40')+p);}this[b('0x39')][b('0x41')](p);this[b('0x3b')](p);if(this[b('0x16')]&&p===this[b('0x16')]['id']){this['_aboutDialog']=null;}else if(this[b('0x14')]&&p===this[b('0x14')]['id']){this[b('0x14')]=null;this[b('0x18')][b('0x42')]();this[b('0x15')][b('0x2d')][b('0x43')]();}else if(this[b('0x17')]&&p===this[b('0x17')]['id']){this[b('0x17')]=null;}};}async[b('0x31')](){if(this['_auth']){return this[b('0x17')];}this[b('0x17')]=await createAuthWindow();const q=urls['get'](b('0x2c'));this[b('0x17')][b('0x2f')](q);this[b('0x17')]['on']('ready-to-show',this[b('0x34')](this[b('0x17')]));this[b('0x17')]['on']('close',this[b('0x35')](this['_auth']));this[b('0x39')][b('0x44')](r=>{if(r['id']!==this['_auth']['id']){r['close']();}});this[b('0x15')]['taskLauncher']['stop']();return this[b('0x17')];}async[b('0x45')](){if(this[b('0x14')]){return this['_main'];}this[b('0x14')]=await createMainWindow();this[b('0x15')][b('0x2d')][b('0x46')]();const s=urls[b('0x30')](b('0x13'));this[b('0x14')][b('0x2f')](s);this[b('0x14')]['on'](b('0x33'),this[b('0x34')](this[b('0x14')]));this[b('0x14')]['on'](b('0x47'),this[b('0x35')](this['_main']));this[b('0x39')][b('0x44')](t=>{if(t['id']!==this['_main']['id']){t['close']();}});return this[b('0x14')];}[b('0x3b')](u){const v=[];this[b('0x39')][b('0x44')]((w,x)=>{v[b('0x48')](x);});this[b('0x39')][b('0x44')](y=>{if(y['id']===u){return;}y['webContents'][b('0x49')](IPCKeys[b('0x4a')],v);});}static['_onRequestCheckForUpdates'](){log[b('0x3c')](b('0x3d'));autoUpdater['checkForUpdatesAndNotify']();}[b('0x1b')](z,A,B){if(A==='captcha'){this['_captchaWindowManager'][b('0x4b')](B);z[b('0x4c')][b('0x49')](IPCKeys['FinishCreateNewWindow']);}else{try{const C=this[b('0x27')](A);z[b('0x4c')]['send'](IPCKeys[b('0x4d')]);this[b('0x3b')](C['id']);}catch(D){console[b('0x3f')](b('0x4e'),D[b('0x4f')]);z['sender'][b('0x49')](IPCKeys[b('0x4d')]);}}}[b('0x1d')](E,F,G){const H=this[b('0x39')][b('0x30')](F);if(H){H[b('0x37')][b('0x49')](IPCKeys[b('0x50')],G);}E[b('0x4c')][b('0x49')](IPCKeys['FinishSendMessage']);}[b('0x1f')](I){const J=Array[b('0x51')](this[b('0x39')][b('0x52')]());I['sender'][b('0x49')](IPCKeys['FinishGetWindowIDs'],J);}[b('0x21')](K,L){if(this['_main']&&this['_main']['id']===L){this[b('0x18')][b('0x42')]();this[b('0x39')][b('0x44')](M=>{M[b('0x47')]();});this[b('0x15')][b('0x2d')][b('0x43')]();}else if(this[b('0x17')]&&this[b('0x17')]['id']===L){this['_captchaWindowManager'][b('0x42')]();this['_windows'][b('0x44')](N=>{N[b('0x47')]();});}}[b('0x53')](O,P){this[b('0x18')]['startHarvesting'](O,P);}[b('0x54')](Q,R){this[b('0x18')][b('0x55')](Q,R);}[b('0x56')](){return this[b('0x18')][b('0x56')]();}}module[b('0x57')]=WindowManager;